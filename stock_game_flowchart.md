# 股票投資小遊戲流程圖

## 系統概述
這是一個模擬股票投資的網頁小遊戲，使用 Polygon.io API 獲取真實股票數據，並通過 Chart.js 顯示股價走勢。玩家可以進行買入和賣出操作，管理自己的虛擬投資組合。

## 主要功能
- 使用 Polygon.io API 獲取股票數據（免費額度，低頻率更新）
- Chart.js 折線圖顯示股價走勢
- 玩家戶頭管理（初始金額 $1000）
- 股票買入/賣出功能
- 投資金額追蹤
- 重置功能

## 系統流程圖

```mermaid
flowchart TD
    A[🎮 遊戲開始] --> B[⚙️ 系統初始化]
    B --> C[💰 設定初始狀態<br/>戶頭餘額: $1000<br/>股票投資: $0]
    C --> D[🔄 啟動定時器<br/>定期獲取 Polygon.io 股票數據]
    
    D --> E[📊 獲取股票數據成功?]
    E -->|✅ 成功| F[📈 更新 Chart.js 折線圖]
    E -->|❌ 失敗| G[⚠️ 顯示 API 錯誤訊息]
    G --> H[⏰ 等待下次更新週期]
    
    F --> I[🖥️ 更新 UI 顯示<br/>- 當前股價<br/>- 戶頭餘額<br/>- 股票投資金額]
    I --> J[👤 等待用戶操作]
    
    J --> K{🎯 用戶選擇操作}
    
    K -->|💵 輸入金額 + 買入| L[🔍 驗證買入條件]
    K -->|💸 輸入金額 + 賣出| M[🔍 驗證賣出條件]
    K -->|🔄 重置遊戲| N[♻️ 重置所有數據]
    K -->|⏳ 無操作| O[⏰ 繼續等待]
    
    L --> P{💰 戶頭餘額是否足夠?}
    P -->|✅ 足夠| Q[✨ 執行買入交易<br/>- 扣除戶頭金額<br/>- 增加股票投資]
    P -->|❌ 不足| R[❌ 顯示餘額不足錯誤]
    
    M --> S{📈 股票投資是否足夠?}
    S -->|✅ 足夠| T[✨ 執行賣出交易<br/>- 減少股票投資<br/>- 增加戶頭金額]
    S -->|❌ 不足| U[❌ 顯示投資不足錯誤]
    
    N --> V[🔄 重置為初始狀態<br/>戶頭餘額: $1000<br/>股票投資: $0]
    V --> I
    
    Q --> W[📊 更新交易記錄]
    T --> W
    W --> I
    
    R --> J
    U --> J
    O --> J
    
    H --> D
    
    style A fill:#e1f5fe
    style C fill:#f3e5f5
    style F fill:#e8f5e8
    style Q fill:#e8f5e8
    style T fill:#e8f5e8
    style R fill:#ffebee
    style U fill:#ffebee
    style G fill:#fff3e0
```

## 技術實現要點

### API 集成
- 使用 Polygon.io 免費 API 獲取股票數據
- 設定適當的請求頻率以避免超出免費額度
- 實現錯誤處理和重試機制

### 圖表顯示
- 使用 Chart.js 創建響應式折線圖
- 實時更新股價數據
- 提供良好的視覺化體驗

### 用戶界面
- 清晰顯示戶頭餘額和投資金額
- 直觀的買入/賣出操作界面
- 即時的交易反饋和錯誤提示

### 數據管理
- 本地存儲用戶的投資狀態
- 交易記錄的追蹤和顯示
- 重置功能的完整實現
